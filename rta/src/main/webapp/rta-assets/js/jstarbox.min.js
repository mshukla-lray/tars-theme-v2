!function(){var a="jstarbox-data",b=".jstarbox",c={average:.5,stars:5,buttons:5,ghosting:!1,changeable:!0,autoUpdateAverage:!1,direction:"ltr"},d={destroy:function(){this.removeData(a),this.unbind(b).find("*").unbind(b),this.removeClass("starbox"),this.empty()},getValue:function(){var b=this.data(a);return b.opts.currentValue},setValue:function(b){var c=this.data(a),d=arguments[1]||c.positioner.width(),e=arguments[2];e&&c.ghost.css({width:""+b*d+"px"}),c.colorbar.css({width:""+b*d+"px"}),c.opts.currentValue=b},getOption:function(b){var c=this.data(a);return c.opts[b]},setOption:function(b,c){var d=this.data(a);"changeable"===b&&c===!1&&d.positioner.triggerHandler("mouseleave"),d.opts[b]=c,"stars"===b?d.methods.update_stars():"average"===b&&this.starbox("setValue",c,null,!0)},markAsRated:function(){var b=this.data(a);b.positioner.addClass("rated")}};jQuery.fn.extend({starbox:function(e){return e.constructor===String&&d[e]?d[e].apply(this,Array.prototype.slice.call(arguments,1))||this:(e=jQuery.extend({},c,e),this.each(function(c){var f=jQuery(this),g=jQuery.extend({},e),h={opts:g,methods:{}};f.data(a,h);var i=h.positioner=jQuery("<div/>").addClass("positioner"),j=h.stars=jQuery("<div/>").addClass("stars").appendTo(i),k=h.ghost=jQuery("<div/>").addClass("ghost").hide().appendTo(j),m=(h.colorbar=jQuery("<div/>").addClass("colorbar").appendTo(j),h.star_holder=jQuery("<div/>").addClass("star_holder").appendTo(j));f.empty().addClass("starbox").append(i),h.methods.update_stars=function(){m.empty();for(var a=0;a<g.stars;a++){jQuery("<div/>").addClass("star").addClass("star-"+a).appendTo(m)}d.setOption.call(f,"average",g.average)},h.methods.update_stars(),i.bind("mousemove"+b,function(a){if(g.changeable){g.ghosting&&k.show();var b=i.width(),c=a.layerX;void 0===c&&(c=a.pageX-i.offset().left);var e=c/b;g.buttons&&(e*=g.buttons,e=Math.floor(e),e+=1,e/=g.buttons,"rtl"==g.direction&&(e=1.2-e,e=Math.round(10*e)/10)),i.addClass("hover"),d.setValue.call(f,e,b),f.starbox("setValue",e,b),f.triggerHandler("starbox-value-moved",e)}}),i.bind("mouseleave"+b,function(a){g.changeable&&(k.hide(),i.removeClass("hover"),d.setValue.call(f,g.average))}),i.bind("click"+b,function(a){if(g.changeable){g.autoUpdateAverage&&(d.markAsRated.call(f),d.setOption.call(f,"average",g.currentValue));var b=f.triggerHandler("starbox-value-changed",g.currentValue);!isNaN(parseFloat(b))&&isFinite(b)&&d.setOption.call(f,"average",b),"once"===g.changeable&&d.setOption.call(f,"changeable",!1)}}),"rtl"==g.direction?$(".starbox .colorbar, .starbox .ghost").css("right","0"):$(".starbox .colorbar, .starbox .ghost").css("left","0")}),this)}})}();